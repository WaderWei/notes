# 全局主键

![1571588472883](.\全局主键.assets\1571588472883.png)

![1571588493022](.\全局主键.assets\1571588493022.png)

![1571588600281](.\全局主键.assets\1571588600281.png)

计数器方式的缺点：

mycat之间的计数文件无法在多个mycat之间共享，因此当第一个mycat挂掉以后，第二个mycat无法继续在第一个mycat生成的主键基础上继续工作。

![1571588812215](.\全局主键.assets\1571588812215.png)

数据同步：pxc(效率低)或者replication(不强一致)都有问题

![1571588984574](.\全局主键.assets\1571588984574.png)

**最推荐的是用Zookeeper**

![1571589031885](.\全局主键.assets\1571589031885.png)

![1571589109970](.\全局主键.assets\1571589109970.png)

![1571589144983](.\全局主键.assets\1571589144983.png)

3：表示用Zookeeper生成主键值

![1571589216905](.\全局主键.assets\1571589216905.png)

![1571589257575](.\全局主键.assets\1571589257575.png)

loadZk：表示用Zookeeper生成主键

zkURL：配置Zookerper的Ip地址和映射的端口号

clusterId：mycat集群的名称

myid：当前mycat的名称

clusterNodes：mycat集群的名称，这里只有一个



获取全局主键：

![1571589504726](.\全局主键.assets\1571589504726.png)

**主键的数据类型要是bigint**





