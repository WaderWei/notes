# 常见问题及解决方案3

### 数据库缓存、程序缓存应该选择哪一个

![1571152512865](.\常见问题及解决方案3.assets\1571152512865.png)

数据库的数据都是保存在硬盘中的，硬盘的读写书读很慢。

![1571152586351](.\常见问题及解决方案3.assets\1571152586351.png)

内存中的数据到底由谁来管理？java or mysql

![1571152665087](.\常见问题及解决方案3.assets\1571152665087.png)

![1571152688711](.\常见问题及解决方案3.assets\1571152688711.png)

![1571152730315](.\常见问题及解决方案3.assets\1571152730315.png)

**结论：不用数据库的查询缓存**

![1571152845562](.\常见问题及解决方案3.assets\1571152845562.png)

### 程序缓存的优势

![1571152963653](.\常见问题及解决方案3.assets\1571152963653.png)

关系表A与B数据不经常改变，可以设置缓存

![1571153070495](.\常见问题及解决方案3.assets\1571153070495.png)

表连接不确定那张表经常修改，那张表不经常修改，所以不建议缓存表连接的数据

![1571153138332](.\常见问题及解决方案3.assets\1571153138332.png)

缓存的数据一般都是不经常改变的，详细自行百度学习。



### 智能拆分订单

![1571153545861](.\常见问题及解决方案3.assets\1571153545861.png)

购买者当地没有库存，优先从最近有库存的仓库发货。

![1571153608066](.\常见问题及解决方案3.assets\1571153608066.png)

![1571153628181](.\常见问题及解决方案3.assets\1571153628181.png)

![1571153642931](.\常见问题及解决方案3.assets\1571153642931.png)

创建密钥

![1571153711828](.\常见问题及解决方案3.assets\1571153711828.png)

![1571154088201](.\常见问题及解决方案3.assets\1571154088201.png)

获取一个地方的经度和纬度。

**修改t_warehouse表**

![1571154216201](.\常见问题及解决方案3.assets\1571154216201.png)

**修改t_warehouse_history**

![1571154259471](.\常见问题及解决方案3.assets\1571154259471.png)

![1571154442324](.\常见问题及解决方案3.assets\1571154442324.png)

获取离你最近的一个仓库地址sql

![1571154718242](.\常见问题及解决方案3.assets\1571154718242.png)





最终sql：获取此商品最近的有库存的仓库id

![1571155315208](.\常见问题及解决方案3.assets\1571155315208.png)

![1571155273719](.\常见问题及解决方案3.assets\1571155273719.png)



