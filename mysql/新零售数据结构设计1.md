# 新零售数据结构设计1

### SPU与SKU区别

#### SPU
SPU = Standard Product Unit (标准产品单位)
SPU 是商品信息聚合的最小单位，是一组可复用、易检索的标准化信息的集合，该集合描述 了一个产品的特性。通俗点讲，属性值、特性相同的商品就可以称为一个 SPU。
例如:iphone7 就是一个 SPU，与商家，与颜色、款式、套餐都无关

**注：一般情况下，大多数物品的展示是先查找spu表，因为spu表的数据要比sku少很多，检索速度快，再根据检索到的spu编号去查找sku。**

#### SKU
SKU=stock keeping unit(库存量单位)
SKU 即库存进出计量的单位，是物理上不可分割的最小存货单元。
例如:纺织品中一个 SKU 通常表示:规格、颜色、款式。

下图的参数组合起来就是一个sku

![1570537199883](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570537199883.png)

这里注意：库存的设计，如果仅仅是给一个没有分店，不涉及到仓库的商店设计数据库，则库存信息放在sku表中即可，但如果是给有多个商店和多个仓库的设计数据库，则库存的字段要放在sku与仓库的关联表中，sku表与仓库表是多对多的关系，一个sku可能在上海的仓库有200个，也可能在北京的仓库300个，一个上海的仓库不可能只有一个sku。



### SKU与参数如何对应？品类不同参数不同。

##### 错误的设计方式

![1570537698313](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570537698313.png)

spu很多，对应的商品参数可能成千上万，若果这样设计，将会导致一张sku表的字段很多。

##### 正确的设计方式

![1570537886334](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570537886334.png)

品类表保存各种门类信息(手机，电脑，毛衣，裤子等都是门类)，而参数表则用来保存一个门类对应的所有参数（手机门类-------->对应的参数：CPU，内存，尺寸，电池等）。当想要给手机增加或者减少一个参数时，只需要在参数表中插入或者删除手机对应的记录即可。

#### 参数与SKU的关系

![1570539414652](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570539414652.png)

![1570540568961](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570540568961.png)

##### 品类表设计

![1570539584608](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570539584608.png)

表的命名规范：一般以**t_**开头是表，以**v_**开头是视图，不同单词之间用下划线_分隔。

![1570539781358](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570539781358.png)

因为可以给品类编号设计一些业务规则的逻辑，比如门类编号为10001-11000的为手机，110001-12000为笔记本电脑，这样看到编号更容易理解这是什么门类物品。

![1570540014518](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570540014518.png)

![1570539999107](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570539999107.png)

![1570541257537](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541257537.png)

##### 参数表

![1570540979958](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570540979958.png)

参数编号：代表在某个门类记录对应的参数计数。

是否为数据？：某些参数的值可能是文字，比如颜色；而某些参数的值可能是数字，比如内存。

单位名称(0)：某些参数的值可能有单位：比如内存（GB），而有些参数的值没有单位，比如颜色。

是否为通用参数？：代表这个参数是否是显示在主要位置

参数值(0)：规定参数值得可选范畴，比如分辨率：720p/1080p/4K/8K,防止用户随便填写。

![1570541130227](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541130227.png)

![1570541151808](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541151808.png)

![1570541215234](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541215234.png)



#### 设计品牌与分类表

> 产品是有品牌与分类的，因此要先设计品牌表与分类表。

##### 品牌表

![1570541539261](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541539261.png)

商标图片(0)：文件保存在硬盘上，数据库中保存文件的路径即可。

首字母：方便用户查找

![1570541555807](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541555807.png)

![1570541931344](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541931344.png)

##### 分类表

![1570541714932](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541714932.png)

排名指数：搜索权重，根据业务规则决定大小，即在前端页面排序的先后。

![1570541754088](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541754088.png)

![1570541772871](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541772871.png)

![1570541995414](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541995414.png)

##### 分类与品牌关联表

> 一个分类可以包含多个品牌，一个品牌可以有多个分类。多对多关系

![1570541893516](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541893516.png)

![1570541909525](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570541909525.png)

![1570542068712](H:\gitwork\notes\VMware\新零售数据结构设计.assets\1570542068712.png)



### 问题解答

1. 是否在表中都要添加create_time和update_time字段

   > 不经常改变的字典数据就不用加上时间字段，比如说城市表、民族表、类型表等等。

2. 在品类表里，我们定义了手机、手机线等品类，而在分类表里，我们又重新定义了手机、手机电池等等，只不过变成了树状的数据结构。
   那么这两个表有什么区别呢？各自的作用是什么？

   > 品类表和分类表是用在不同的模块里面，品类表是跟商品模块有关系，录入商品的时候根据选择的商品品类，来限制用户可以录入的参数。分类是用在页面导航上面的，某个分类下面还有什么分类

3. 上传图片时需要保存图片的完整路径吗（如https://xxxx.com/xx/xx.jpg），还是直接保存根路径下的图片地址(/xx/xxx.jpg)

   > 保存相对路径，因为以后图床服务器地址变了，岂不是要修改很多数据记录？所以还是用相对地址好一些

4. 设置索引的前提条件是记录的多少，以及是否作为检索条件。跟0和1没有关系

5. 

6. 关于关联表的问题，为什么我们不使用外键呢？而要手动去创建关联表。

   > 外键用多了会产生闭环结构，比如四张表互相设置外键，最终的结果只能是每个表的数据既不能修改也不能删除，因此只用逻辑外键，不用物理外键
   >
   > 有三张表，没两张表都有外键约束，最终变成闭环的外键约束，你无法删除三张表里任何一条记录。如果真实的数据库里边还有几十张，几百张数据表，那么你都用外键约束的话，会形成大闭环套小闭环，数据没发维护

   

   

   

