# 新零售数据结构设计2

### 设计产品表与商品表

##### 产品表

![1570542286744](.\新零售数据结构设计2.assets\1570542286744.png)

品牌编号(0)：有些产品是没有品牌的。

![1570543521196](.\新零售数据结构设计2.assets\1570543521196.png)

**注：一般不对长varchar的字段加索引。**

![1570543605149](.\新零售数据结构设计2.assets\1570543605149.png)

#### 商品表

![1570543683700](.\新零售数据结构设计2.assets\1570543683700.png)

![1570543733360](.\新零售数据结构设计2.assets\1570543733360.png)

这里images与param字段值都是以json保存。

![1570543802496](.\新零售数据结构设计2.assets\1570543802496.png)

#### 数据

t_spu

![1570543853218](.\新零售数据结构设计2.assets\1570543853218.png)

t_category

![1570543948825](.\新零售数据结构设计2.assets\1570543948825.png)

t_brand

![1570543915823](.\新零售数据结构设计2.assets\1570543915823.png)

t_spec_group

![1570543990329](.\新零售数据结构设计2.assets\1570543990329.png)

t_sku：一个产品可以对应多个商品

![1570544016728](.\新零售数据结构设计2.assets\1570544016728.png)

images：

![1570544087502](.\新零售数据结构设计2.assets\1570544087502.png)

param：

![1570544166368](.\新零售数据结构设计2.assets\1570544166368.png)

### 问题

部分字段类型为json，如果josn类型的字段涉及筛选该怎么做呢？通常josn字段不设查找。
比如，你在商品表里，将商品参数就设为了json，假如我想按照cpu或者屏幕尺寸筛选手机，该如何做呢？

> [json字段使用](https://blog.csdn.net/szxiaohe/article/details/82772881)



## 如何设计库存

> 如果新零售店没有分店，则可以把库存定义到商品表中

![1570545548686](.\新零售数据结构设计2.assets\1570545548686.png)

#### 零售店与仓库的对应关系

![1570545675283](.\新零售数据结构设计2.assets\1570545675283.png)

一个零售店可以从多个仓库中取货，一个仓库也可以给多个零售店发货，所以零售店与仓库是多对多的关系。

那么，**是不是多对多的关系就要定义联合主键的中间表**，当然不是，如果这样的话，零售店与仓库的关系就绑定死了，当绑定的仓库都没有货时，零售店无法从其它仓库中取货，因此中间表中不能用联合主键。



注意：零售店中可以保存商品，仓库也可以保存商品，那么他们之间的库存如何设计？

![1570546021504](.\新零售数据结构设计2.assets\1570546021504.png)

1. 零售店与商品是多对多的关系，因此零售店中商品的库存表现在中间表中
2. 仓库与商品是多堆垛的关系，一次仓库中商品的库存也表现在中间表中



#### 创建省份与城市表

> 零售店与仓库都有所在城市字段，因此要先创建这两张表

![1570546267668](.\新零售数据结构设计2.assets\1570546267668.png)

![1570546323181](.\新零售数据结构设计2.assets\1570546323181.png)



#### 仓库与库存(仓库与商品的中间表)

![1570546438507](.\新零售数据结构设计2.assets\1570546438507.png)



![1570546472271](.\新零售数据结构设计2.assets\1570546472271.png)



![1570546493431](.\新零售数据结构设计2.assets\1570546493431.png)



#### 零售店与库存(零售店与商品的中间表)

![1570546563225](.\新零售数据结构设计2.assets\1570546563225.png)

![1570546641457](.\新零售数据结构设计2.assets\1570546641457.png)![1570546656006](.\新零售数据结构设计2.assets\1570546656006.png)



t_warehouse

![1570546686538](.\新零售数据结构设计2.assets\1570546686538.png)

t_warehouse_sku

![1570546728070](.\新零售数据结构设计2.assets\1570546728070.png)



